{"version":3,"file":"index.js","sources":["pages/index/index.vue","../../../../../Program Files/HBuilderX/plugins/uniapp-cli-vite/uniPage:/cGFnZXMvaW5kZXgvaW5kZXgudnVl"],"sourcesContent":["<template>\n  <view class=\"container\">\n    <view class=\"welcome-section\">\n      <text class=\"welcome-title\">Ê¨¢ËøéÂõûÊù•Ôºå{{ userInfo?.username || '‰ºöÂëò' }}</text>\n      <text class=\"welcome-desc\">‰ªäÂ§©ÊòØ {{ currentDate }}</text>\n    </view>\n\n    <!-- ‰ºöÂëòÂç°Áä∂ÊÄÅÂç°Áâá -->\n    <view class=\"card membership-card\">\n      <view class=\"card-header\">\n        <text class=\"card-title\">ÊàëÁöÑ‰ºöÂëòÂç°</text>\n      </view>\n      <view class=\"card-content\">\n        <view v-if=\"membership\" class=\"membership-info\">\n          <text class=\"membership-type\">{{ membership.membership_type || 'Ê†áÂáÜ‰ºöÂëò' }}</text>\n          <view class=\"membership-date\">\n            <text>ÊúâÊïàÊúüËá≥Ôºö{{ formatDate(membership.expiry_date, 'YYYY-MM-DD') }}</text>\n            <text :class=\"['status-tag', isExpired(membership.expiry_date) ? 'expired' : 'valid']\">\n              {{ isExpired(membership.expiry_date) ? 'Â∑≤ËøáÊúü' : 'ÊúâÊïà' }}\n            </text>\n          </view>\n        </view>\n        <view v-else class=\"empty\">\n          <text>ÊöÇÊó†‰ºöÂëòÂç°‰ø°ÊÅØ</text>\n        </view>\n      </view>\n    </view>\n\n    <!-- ‰ªäÊó•ËØæÁ®ãÂç°Áâá -->\n    <view class=\"card today-course-card\">\n      <view class=\"card-header\">\n        <text class=\"card-title\">‰ªäÊó•ËØæÁ®ã</text>\n      </view>\n      <view class=\"card-content\">\n        <view v-if=\"todayCourses.length > 0\" class=\"course-list\">\n          <view\n            v-for=\"course in todayCourses\"\n            :key=\"course.course_id\"\n            class=\"course-item\"\n            @click=\"goToCourses\"\n          >\n            <text class=\"course-name\">{{ course.course_name }}</text>\n            <text class=\"course-time\">{{ formatDate(course.schedule, 'HH:mm') }}</text>\n          </view>\n        </view>\n        <view v-else class=\"empty\">\n          <text>‰ªäÊó•ÊöÇÊó†ËØæÁ®ã</text>\n        </view>\n      </view>\n    </view>\n\n    <!-- È¢ÑÁ∫¶Ê¶ÇËßàÂç°Áâá -->\n    <view class=\"card reservation-card\">\n      <view class=\"card-header\">\n        <text class=\"card-title\">È¢ÑÁ∫¶Ê¶ÇËßà</text>\n      </view>\n      <view class=\"card-content\">\n        <view class=\"reservation-stats\">\n          <view class=\"stat-item\">\n            <text class=\"stat-value\">{{ reservationStats.total }}</text>\n            <text class=\"stat-label\">ÊÄªÈ¢ÑÁ∫¶</text>\n          </view>\n          <view class=\"stat-item\">\n            <text class=\"stat-value primary\">{{ reservationStats.pending }}</text>\n            <text class=\"stat-label\">ÂæÖÂºÄÂßã</text>\n          </view>\n          <view class=\"stat-item\">\n            <text class=\"stat-value success\">{{ reservationStats.completed }}</text>\n            <text class=\"stat-label\">Â∑≤ÂÆåÊàê</text>\n          </view>\n        </view>\n      </view>\n    </view>\n\n    <!-- Âø´Êç∑ÂÖ•Âè£ -->\n    <view class=\"card quick-actions-card\">\n      <view class=\"card-header\">\n        <text class=\"card-title\">Âø´Êç∑ÂÖ•Âè£</text>\n      </view>\n      <view class=\"quick-actions\">\n        <view class=\"action-item\" @click=\"goToCourses\">\n          <text class=\"action-icon\">üìÖ</text>\n          <text class=\"action-text\">ËØæÁ®ãÈ¢ÑÁ∫¶</text>\n        </view>\n        <view class=\"action-item\" @click=\"goToLockers\">\n          <text class=\"action-icon\">üì¶</text>\n          <text class=\"action-text\">ÂÇ®Áâ©Êüú</text>\n        </view>\n        <view class=\"action-item\" @click=\"goToProfile\">\n          <text class=\"action-icon\">üë§</text>\n          <text class=\"action-text\">‰∏™‰∫∫‰∏≠ÂøÉ</text>\n        </view>\n      </view>\n    </view>\n  </view>\n</template>\n\n<script>\nimport userStore from '../../store/user.js'\nimport { getMembership } from '../../api/membership.js'\nimport { getCourses } from '../../api/course.js'\nimport { getReservations } from '../../api/reservation.js'\nimport { formatDate, isExpired } from '../../utils/date.js'\n\nexport default {\n  data() {\n    return {\n      userInfo: null,\n      membership: null,\n      todayCourses: [],\n      reservations: [],\n      currentDate: ''\n    }\n  },\n  computed: {\n    reservationStats() {\n      return {\n        total: this.reservations.length,\n        pending: this.reservations.filter(r => r.status === 'pending' || r.status === 'confirmed').length,\n        completed: this.reservations.filter(r => r.status === 'completed').length\n      }\n    }\n  },\n  onLoad() {\n    // Ê£ÄÊü•ÁôªÂΩïÁä∂ÊÄÅ\n    if (!userStore.getters.isLoggedIn()) {\n      uni.reLaunch({\n        url: '/pages/login/login'\n      })\n      return\n    }\n    this.initDate()\n    this.loadData()\n  },\n  onShow() {\n    // Ê£ÄÊü•ÁôªÂΩïÁä∂ÊÄÅ\n    if (!userStore.getters.isLoggedIn()) {\n      uni.reLaunch({\n        url: '/pages/login/login'\n      })\n      return\n    }\n    // Êõ¥Êñ∞Áî®Êà∑‰ø°ÊÅØ\n    this.userInfo = userStore.state.userInfo\n    // Â¶ÇÊûúËøòÊ≤°ÊúâÁî®Êà∑‰ø°ÊÅØÔºåÂ∞ùËØïËé∑Âèñ\n    if (!this.userInfo && userStore.getters.isLoggedIn()) {\n      userStore.fetchUserInfo().then(() => {\n        this.userInfo = userStore.state.userInfo\n      }).catch(err => {\n        console.error('Ëé∑ÂèñÁî®Êà∑‰ø°ÊÅØÂ§±Ë¥•:', err)\n      })\n    }\n    this.loadData()\n  },\n  methods: {\n    initDate() {\n      const now = new Date()\n      const weekdays = ['ÊòüÊúüÊó•', 'ÊòüÊúü‰∏Ä', 'ÊòüÊúü‰∫å', 'ÊòüÊúü‰∏â', 'ÊòüÊúüÂõõ', 'ÊòüÊúü‰∫î', 'ÊòüÊúüÂÖ≠']\n      const year = now.getFullYear()\n      const month = String(now.getMonth() + 1).padStart(2, '0')\n      const day = String(now.getDate()).padStart(2, '0')\n      const weekday = weekdays[now.getDay()]\n      this.currentDate = `${year}Âπ¥${month}Êúà${day}Êó• ${weekday}`\n    },\n    async loadData() {\n      // Ëé∑ÂèñÁî®Êà∑‰ø°ÊÅØ\n      if (userStore.getters.isLoggedIn()) {\n        try {\n          // Â¶ÇÊûú store ‰∏≠Ê≤°ÊúâÁî®Êà∑‰ø°ÊÅØÔºåÂÖàËé∑Âèñ\n          if (!userStore.state.userInfo) {\n            await userStore.fetchUserInfo()\n          }\n          // Êõ¥Êñ∞Êú¨Âú∞Áî®Êà∑‰ø°ÊÅØ\n          this.userInfo = userStore.state.userInfo\n        } catch (error) {\n          console.error('Ëé∑ÂèñÁî®Êà∑‰ø°ÊÅØÂ§±Ë¥•:', error)\n          // Â¶ÇÊûúËé∑ÂèñÂ§±Ë¥•ÔºåÂ∞ùËØï‰ΩøÁî® store ‰∏≠ÁöÑ‰ø°ÊÅØ\n          this.userInfo = userStore.state.userInfo\n        }\n      }\n\n      // Ëé∑Âèñ‰ºöÂëòÂç°‰ø°ÊÅØ\n      try {\n        const membershipData = await getMembership()\n        this.membership = membershipData\n      } catch (error) {\n        console.error('Ëé∑Âèñ‰ºöÂëòÂç°‰ø°ÊÅØÂ§±Ë¥•:', error)\n      }\n\n      // Ëé∑Âèñ‰ªäÊó•ËØæÁ®ã\n      try {\n        const today = new Date().toISOString().split('T')[0]\n        const coursesData = await getCourses({ date: today })\n        const list = coursesData.courses || coursesData.list || coursesData || []\n        const todayStr = today\n        this.todayCourses = list.filter(course => {\n          const courseDate = new Date(course.schedule).toISOString().split('T')[0]\n          return courseDate === todayStr\n        }).slice(0, 3) // Âè™ÊòæÁ§∫Ââç3‰∏™\n      } catch (error) {\n        console.error('Ëé∑Âèñ‰ªäÊó•ËØæÁ®ãÂ§±Ë¥•:', error)\n      }\n\n      // Ëé∑ÂèñÈ¢ÑÁ∫¶ÂàóË°®\n      try {\n        const reservationsData = await getReservations()\n        this.reservations = Array.isArray(reservationsData) ? reservationsData : (reservationsData.reservations || [])\n      } catch (error) {\n        console.error('Ëé∑ÂèñÈ¢ÑÁ∫¶ÂàóË°®Â§±Ë¥•:', error)\n      }\n    },\n    goToCourses() {\n      uni.switchTab({\n        url: '/pages/courses/courses'\n      })\n    },\n    goToLockers() {\n      uni.navigateTo({\n        url: '/pages/lockers/lockers'\n      })\n    },\n    goToProfile() {\n      uni.switchTab({\n        url: '/pages/profile/profile'\n      })\n    },\n    formatDate,\n    isExpired\n  }\n}\n</script>\n\n<style scoped>\n.container {\n  padding: 40rpx;\n  background: #f5f7fa;\n  min-height: 100vh;\n}\n\n.welcome-section {\n  margin-bottom: 40rpx;\n}\n\n.welcome-title {\n  display: block;\n  font-size: 56rpx;\n  font-weight: 600;\n  color: #303133;\n  margin-bottom: 16rpx;\n}\n\n.welcome-desc {\n  display: block;\n  font-size: 28rpx;\n  color: #909399;\n}\n\n.card {\n  background: #ffffff;\n  border-radius: 24rpx;\n  padding: 40rpx;\n  margin-bottom: 32rpx;\n  box-shadow: 0 4rpx 16rpx rgba(0, 0, 0, 0.05);\n}\n\n.card-header {\n  margin-bottom: 32rpx;\n  padding-bottom: 24rpx;\n  border-bottom: 1px solid #f0f0f0;\n}\n\n.card-title {\n  font-size: 32rpx;\n  font-weight: 600;\n  color: #303133;\n}\n\n.card-content {\n  min-height: 120rpx;\n}\n\n.membership-info {\n  display: flex;\n  flex-direction: column;\n  gap: 24rpx;\n}\n\n.membership-type {\n  font-size: 48rpx;\n  font-weight: 600;\n  color: #303133;\n}\n\n.membership-date {\n  display: flex;\n  justify-content: space-between;\n  align-items: center;\n  font-size: 28rpx;\n  color: #606266;\n}\n\n.status-tag {\n  padding: 8rpx 24rpx;\n  border-radius: 8rpx;\n  font-size: 24rpx;\n}\n\n.status-tag.valid {\n  background: #f0f9ff;\n  color: #67c23a;\n}\n\n.status-tag.expired {\n  background: #fef0f0;\n  color: #f56c6c;\n}\n\n.course-list {\n  display: flex;\n  flex-direction: column;\n  gap: 24rpx;\n}\n\n.course-item {\n  display: flex;\n  justify-content: space-between;\n  align-items: center;\n  padding: 24rpx 0;\n  border-bottom: 1px solid #f0f0f0;\n}\n\n.course-item:last-child {\n  border-bottom: none;\n}\n\n.course-name {\n  font-size: 28rpx;\n  color: #303133;\n  font-weight: 500;\n}\n\n.course-time {\n  font-size: 28rpx;\n  color: #909399;\n}\n\n.reservation-stats {\n  display: flex;\n  justify-content: space-around;\n  align-items: center;\n}\n\n.stat-item {\n  display: flex;\n  flex-direction: column;\n  align-items: center;\n  gap: 16rpx;\n}\n\n.stat-value {\n  font-size: 64rpx;\n  font-weight: 600;\n  color: #303133;\n}\n\n.stat-value.primary {\n  color: #667eea;\n}\n\n.stat-value.success {\n  color: #67c23a;\n}\n\n.stat-label {\n  font-size: 28rpx;\n  color: #909399;\n}\n\n.quick-actions {\n  display: flex;\n  justify-content: space-around;\n  align-items: center;\n  gap: 32rpx;\n}\n\n.action-item {\n  display: flex;\n  flex-direction: column;\n  align-items: center;\n  gap: 16rpx;\n  flex: 1;\n}\n\n.action-icon {\n  font-size: 64rpx;\n}\n\n.action-text {\n  font-size: 28rpx;\n  color: #303133;\n}\n\n.empty {\n  text-align: center;\n  padding: 60rpx 0;\n  color: #909399;\n  font-size: 28rpx;\n}\n</style>\n","import MiniProgramPage from 'D:/Code/Java/CloudFitness/user/cloudfit/pages/index/index.vue'\nwx.createPage(MiniProgramPage)"],"names":["userStore","uni","getMembership","getCourses","getReservations","formatDate","isExpired"],"mappings":"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"}